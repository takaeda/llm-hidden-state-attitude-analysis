# LLM Hidden State Attitude Analysis

Large Language Model (LLM)ã®éš ã‚ŒçŠ¶æ…‹è§£æã«ã‚ˆã‚‹æ¨è«–æ…‹åº¦æ¸¬å®šã®æ•™æ

## æ¦‚è¦
å¯¾ç«‹å‘½é¡Œã¸ã®åå¿œã‚’é€šã˜ã¦LLMã®æ–­å®šæ€§ãƒ»æ…é‡æ€§ã‚’å¯è¦–åŒ–ã™ã‚‹æ‰‹æ³•ã®å­¦ç¿’æ•™æã§ã™ã€‚ç†è«–å­¦ç¿’ã‹ã‚‰å®Ÿè·µçš„ãªè§£æã¾ã§ã€æ®µéšçš„ã«å­¦ã¹ã‚‹ã‚ˆã†ã«æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ¯ å­¦ç¿’ã®é€²ã‚æ–¹

### 1. ç†è«–å­¦ç¿’ï¼šã‚¹ãƒ©ã‚¤ãƒ‰è³‡æ–™ã§åŸºç¤ã‚’ç†è§£
ğŸ“Š **[æˆæ¥­ç”¨ã‚¹ãƒ©ã‚¤ãƒ‰è³‡æ–™](SLIDES.md)**
- LLMã®éš ã‚ŒçŠ¶æ…‹ã¨ã¯ä½•ã‹
- HBDIï¼ˆHidden Bias Detection Indexï¼‰æŒ‡æ¨™ã®ç†è§£
- å®Ÿéš›ã®æ¸¬å®šçµæœã¨ãã®è§£é‡ˆ
- å„LLMã®æ¨è«–æ…‹åº¦ã®é•ã„

### 2. å®Ÿè·µå­¦ç¿’ï¼šè§£æãƒ„ãƒ¼ãƒ«ã§ä½“é¨“
ğŸ”¬ **[Hidden Stateè§£æãƒ„ãƒ¼ãƒ«ã‚­ãƒƒãƒˆ](hidden_state_analysis/)**

#### ğŸš€ ã™ãã«å§‹ã‚ã‚‹
- **[ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](hidden_state_analysis/setup_and_check.ipynb)** - å¿…è¦ãªä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨å‹•ä½œç¢ºèª
- **[ãƒ¡ã‚¤ãƒ³è§£æãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯](hidden_state_analysis/hidden_state_analysis_notebook.ipynb)** - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªè§£æä½“é¨“

#### ğŸ“‹ è©³ç´°æƒ…å ±
- **[è§£æãƒ„ãƒ¼ãƒ«ã®ä½¿ã„æ–¹](hidden_state_analysis/README.md)** - è©³ç´°ãªèª¬æ˜ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°
- **[ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¦ä»¶](hidden_state_analysis/requirements.txt)** - å¿…è¦ãªPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒª

#### ğŸ“Š è§£æçµæœãƒ‡ãƒ¼ã‚¿
- **[è§£æçµæœç”»åƒ](hidden_state_analysis/hidden_state_analysis_results.png)** - 4ã¤ã®ã‚°ãƒ©ãƒ•ã«ã‚ˆã‚‹å¯è¦–åŒ–
- **[HBDIæŒ‡æ¨™ãƒ‡ãƒ¼ã‚¿](hidden_state_analysis/hbdi_scores.csv)** - å„ãƒ¢ãƒ‡ãƒ«ã®HBDIå€¤
- **[è·é›¢æ¯”è¼ƒãƒ‡ãƒ¼ã‚¿](hidden_state_analysis/model_distances_comparison.csv)** - è©³ç´°ãªè·é›¢è¨ˆç®—çµæœ

### 3. ä¸Šç´šè€…å‘ã‘ï¼šHidden StateæŠ½å‡ºã®å®Ÿè£…
âš ï¸ **æ³¨æ„ï¼šé«˜æ€§èƒ½GPUãƒ»å¤§å®¹é‡ãƒ¡ãƒ¢ãƒªãŒå¿…è¦**

ğŸ› ï¸ **[Hidden StateæŠ½å‡ºã‚¹ã‚¯ãƒªãƒ—ãƒˆ](hidden_state_extraction/)**
- **[ãƒ¡ã‚¤ãƒ³æŠ½å‡ºã‚¹ã‚¯ãƒªãƒ—ãƒˆ](hidden_state_extraction/extract_hidden_states.py)** - LLMã‹ã‚‰Hidden Stateã‚’å–å¾—
- **[ç’°å¢ƒæ§‹ç¯‰ãƒãƒ‹ãƒ¥ã‚¢ãƒ«](hidden_state_extraction/setup_manual.md)** - å®Ÿè¡Œç’°å¢ƒã®è©³ç´°è¨­å®š
- **[æŠ½å‡ºæ¸ˆã¿ãƒ‡ãƒ¼ã‚¿](hidden_state_extraction/results/)** - DeepSeekã€LLaMAã€Qwenã®Hidden State

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
llm-hidden-state-attitude-analysis/
â”œâ”€â”€ README.md                     # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ LICENSE                       # ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æƒ…å ±
â”œâ”€â”€ SLIDES.md                     # ğŸ“Š æˆæ¥­ç”¨ã‚¹ãƒ©ã‚¤ãƒ‰è³‡æ–™
â”œâ”€â”€ hidden_state_analysis/        # ğŸ”¬ è§£æãƒ„ãƒ¼ãƒ«ã‚­ãƒƒãƒˆ
â”‚   â”œâ”€â”€ setup_and_check.ipynb         # ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
â”‚   â”œâ”€â”€ hidden_state_analysis_notebook.ipynb  # ãƒ¡ã‚¤ãƒ³è§£æ
â”‚   â”œâ”€â”€ requirements.txt              # ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ README.md                     # è©³ç´°èª¬æ˜
â”‚   â”œâ”€â”€ hidden_state_analysis_results.png     # è§£æçµæœç”»åƒ
â”‚   â”œâ”€â”€ hbdi_scores.csv                       # HBDIæŒ‡æ¨™
â”‚   â””â”€â”€ model_distances_comparison.csv        # è·é›¢ãƒ‡ãƒ¼ã‚¿
â””â”€â”€ hidden_state_extraction/      # ğŸ› ï¸ Hidden StateæŠ½å‡º
    â”œâ”€â”€ extract_hidden_states.py     # ãƒ¡ã‚¤ãƒ³æŠ½å‡ºã‚¹ã‚¯ãƒªãƒ—ãƒˆ
    â”œâ”€â”€ setup_manual.md              # ç’°å¢ƒæ§‹ç¯‰ãƒãƒ‹ãƒ¥ã‚¢ãƒ«
    â””â”€â”€ results/                     # æŠ½å‡ºæ¸ˆã¿ãƒ‡ãƒ¼ã‚¿
        â”œâ”€â”€ deepseek_hidden_state.csv
        â”œâ”€â”€ llama_hidden_state.csv
        â””â”€â”€ qwen_hidden_state.csv
```

## ğŸ“ å­¦ç¿’ç›®æ¨™

ã“ã®æ•™æã‚’é€šã˜ã¦ä»¥ä¸‹ã‚’å­¦ç¿’ã§ãã¾ã™ï¼š

1. **ç†è«–ç†è§£**
   - LLMã®å†…éƒ¨çŠ¶æ…‹ï¼ˆHidden Stateï¼‰ã®æ¦‚å¿µ
   - å¯¾ç«‹å‘½é¡Œãƒ†ã‚¹ãƒˆã«ã‚ˆã‚‹æ…‹åº¦æ¸¬å®šæ‰‹æ³•
   - HBDIæŒ‡æ¨™ã®è¨ˆç®—æ–¹æ³•ã¨è§£é‡ˆ

2. **å®Ÿè·µã‚¹ã‚­ãƒ«**
   - Jupyter Notebookã‚’ä½¿ã£ãŸ ãƒ‡ãƒ¼ã‚¿è§£æ
   - ã‚³ã‚µã‚¤ãƒ³è·é›¢ã«ã‚ˆã‚‹é¡ä¼¼åº¦è¨ˆç®—
   - æ©Ÿæ¢°å­¦ç¿’çµæœã®å¯è¦–åŒ–æŠ€è¡“

3. **æ‰¹åˆ¤çš„æ€è€ƒ**
   - LLMã®æ¨è«–ãƒ—ãƒ­ã‚»ã‚¹ã®å¤šæ§˜æ€§ç†è§£
   - AIå®‰å…¨æ€§ãƒ»ãƒã‚¤ã‚¢ã‚¹æ¤œå‡ºã®é‡è¦æ€§
   - é©åˆ‡ãªãƒ¢ãƒ‡ãƒ«é¸æŠã®åˆ¤æ–­åŸºæº–

## ğŸ”§ å¿…è¦ãªç’°å¢ƒ

### åŸºæœ¬å­¦ç¿’ï¼ˆã‚¹ãƒ©ã‚¤ãƒ‰ï¼‹è§£æãƒ„ãƒ¼ãƒ«ï¼‰
- Python 3.7+
- Jupyter Notebook/Lab
- æ¨™æº–çš„ãªãƒ‡ãƒ¼ã‚¿åˆ†æãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆpandas, numpy, matplotlibç­‰ï¼‰

### ä¸Šç´šå­¦ç¿’ï¼ˆHidden StateæŠ½å‡ºï¼‰
- é«˜æ€§èƒ½GPUï¼ˆVRAM 8GBä»¥ä¸Šæ¨å¥¨ï¼‰
- CUDAå¯¾å¿œç’°å¢ƒ
- å¤§å®¹é‡ãƒ¡ãƒ¢ãƒªï¼ˆ16GBä»¥ä¸Šæ¨å¥¨ï¼‰

## ğŸ“š é–¢é€£æƒ…å ±

- **å¯¾è±¡ãƒ¬ãƒ™ãƒ«**: æ©Ÿæ¢°å­¦ç¿’ã®åŸºç¤çŸ¥è­˜ã‚’æŒã¤å­¦ç¿’è€…
- **æ¨å¥¨å­¦ç¿’æ™‚é–“**: 2-4æ™‚é–“ï¼ˆè§£æå®Ÿç¿’å«ã‚€ï¼‰
- **ãƒ©ã‚¤ã‚»ãƒ³ã‚¹**: [LICENSE](LICENSE)å‚ç…§

## ğŸ¤ è²¢çŒ®ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

æ”¹å–„ææ¡ˆã‚„ãƒã‚°ãƒ¬ãƒãƒ¼ãƒˆã¯ã€GitHubã®Issuesã¾ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚
